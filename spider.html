<div class="blog-content-box">
<div class="article-header-box">
<div class="article-header">
<div class="article-title-box">
<span class="article-type type-1 float-left">原</span> <h1 class="title-article">Python学习笔记-pandas用法</h1>
</div>
<div class="article-info-box">
<div class="article-bar-top">
<span class="time">2019年03月14日 08:42:07</span>
<a class="follow-nickName" href="https://me.csdn.net/Cris_0525" target="_blank">悟空爱洗头</a>
<span class="read-count">阅读数：24</span>
</div>
<div class="operating">
</div>
</div>
</div>
</div>
<article class="baidu_pl">
<div class="article_content clearfix csdn-tracking-statistics" data-dsm="post" data-mod="popu_307" data-pid="blog" id="article_content">
<link href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css" rel="stylesheet">
<div class="markdown_views prism-atom-one-dark" id="content_views">
<!-- flowchart 箭头图标 勿删 -->
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg"><path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg>
<h3><a id="Python_0"></a>Python数据分析学习</h3>
<p>数据分析相关内容如下图所示：<br/>
<img alt="在这里插入图片描述" height="1000" src="https://img-blog.csdnimg.cn/20190314083406335.png" width="800"/></p>
<h4><a id="1pandas_3"></a>1.pandas简介</h4>
<ol>
<li>Python Data Analysis Library 或 pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。Pandas 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的工具。pandas提供了大量能使我们快速便捷地处理数据的函数和方法。你很快就会发现，它是使Python成为强大而高效的数据分析环境的重要因素之一。</li>
<li>Pandas 是python的一个数据分析包，最初由AQR Capital Management于2008年4月开发，并于2009年底开源出来，目前由专注于Python数据包开发的PyData开发team继续开发和维护，属于PyData项目的一部分。Pandas最初被作为金融数据分析工具而开发出来，因此，pandas为时间序列分析提供了很好的支持。 Pandas的名称来自于面板数据（panel data）和python数据分析（data analysis）。panel data是经济学中关于多维数据集的一个术语，在Pandas中也提供了panel的数据类型。</li>
<li>数据结构：<br/>
（1）Series：一维数组，与Numpy中的一维array类似。二者与Python基本的数据结构List也很相近，其区别是：List中的元素可以是不同的数据类型，而Array和Series中则只允许存储相同的数据类型，这样可以更有效的使用内存，提高运算效率。<br/>
（2）Time- Series：以时间为索引的Series。<br/>
（3）DataFrame：二维的表格型数据结构。很多功能与R中的data.frame类似。可以将DataFrame理解为Series的容器。以下的内容主要以DataFrame为主。<br/>
（4）Panel ：三维的数组，可以理解为DataFrame的容器。<br/>
（5）Pandas 有两种自己独有的基本数据结构。读者应该注意的是，它固然有着两种数据结构，因为它依然是 Python 的一个库，所以，Python 中有的数据类型在这里依然适用，也同样还可以使用类自己定义数据类型。只不过，Pandas 里面又定义了两种数据类型：Series 和 DataFrame，它们让数据操作更简单了。</li>
</ol>
<h4><a id="2Pandas_13"></a>2.Pandas基本用法</h4>
<h5><a id="21_csvread_csv_14"></a>2.1 读取csv文件（read_csv）</h5>
<p>官方示例：</p>
<pre><code class="prism language-python">read_csv<span class="token punctuation">(</span>filepath_or_buffer<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token string">'infer'</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> squeeze<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> prefix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> mangle_dupe_cols<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> engine<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> converters<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> true_values<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> false_values<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> skipinitialspace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> skiprows<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> nrows<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> na_values<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> keep_default_na<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> na_filter<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> skip_blank_lines<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> parse_dates<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> infer_datetime_format<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> keep_date_col<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> date_parser<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> dayfirst<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> iterator<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> chunksize<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> compression<span class="token operator">=</span><span class="token string">'infer'</span><span class="token punctuation">,</span> thousands<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> decimal<span class="token operator">=</span>b<span class="token string">'.'</span><span class="token punctuation">,</span> lineterminator<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> quotechar<span class="token operator">=</span><span class="token string">'"'</span><span class="token punctuation">,</span> quoting<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> escapechar<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> comment<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> dialect<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> tupleize_cols<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> error_bad_lines<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> warn_bad_lines<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> skipfooter<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> doublequote<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> delim_whitespace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> low_memory<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> memory_map<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> float_precision<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre>
<p>常用参数实例：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_name.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
</code></pre>
<p>encoding:编码方式<br/>
sep:指定分隔符<br/>
engine:选择读取的引擎目前来说C更快，但是Python的引擎有更多选择的操作</p>
<ul>
<li>ps：其余参数可查看官方文档的介绍</li>
</ul>
<p>在批量处理csv文件时，当需要对某一列的数值进行迭代打印输出时：<br/>
方法一：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_name.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> df<span class="token punctuation">.</span>index<span class="token punctuation">:</span>
	row <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
	data <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'列名'</span><span class="token punctuation">]</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre>
<p>方法二：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'file_name.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> column<span class="token punctuation">,</span> row <span class="token keyword">in</span> data<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	data <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'列名'</span><span class="token punctuation">]</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre>
<h5><a id="22_csvto_csv_52"></a>2.2 读取csv文件（to_csv）</h5>
<p>官方示例：</p>
<pre><code class="prism language-python">DataFrame<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>path_or_buf<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">', '</span><span class="token punctuation">,</span> na_rep<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> float_format<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> index_label<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> compression<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
quoting<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> quotechar<span class="token operator">=</span><span class="token string">'"'</span><span class="token punctuation">,</span> line_terminator<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">,</span> chunksize<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> tupleize_cols<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> 
date_format<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> doublequote<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> escapechar<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> decimal<span class="token operator">=</span><span class="token string">'.'</span><span class="token punctuation">)</span>
</code></pre>
<p>代码实例：</p>
<pre><code class="prism language-python"><span class="token comment">#coding:utf-8</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span>
c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span>

<span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"表头1"</span><span class="token punctuation">:</span>a<span class="token punctuation">,</span><span class="token string">"表头2"</span><span class="token punctuation">:</span>b<span class="token punctuation">,</span><span class="token string">"表头3"</span><span class="token punctuation">:</span>c<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame <span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">,</span> columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"表头1"</span><span class="token punctuation">,</span><span class="token string">"表头2"</span><span class="token punctuation">,</span><span class="token string">"表头3"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">"testfoo.csv"</span><span class="token punctuation">,</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>


<span class="token triple-quoted-string string">"""
结果：
 表头1 表头2 表头3
0 1 4 8
1 2 5 7
2 3 6 9

"""</span>
</code></pre>
<p><strong>Pandas-DataFrame基础知识点总结</strong></p>
<blockquote>
<ul>
<li>DataFrame是一种表格型数据结构，它含有一组有序的列，每列可以是不同的值。DataFrame既有行索引，也有列索引，它可以看作是由Series组成的字典，不过这些Series公用一个索引。<br/>
DataFrame的创建有多种方式，不过最重要的还是根据dict进行创建，以及读取csv或者txt文件来创建。这里主要介绍这两种方式。</li>
</ul>
</blockquote>
<p>pandas中的DataFrame可以使用一下构造函数创建</p>
<pre><code class="prism language-python">pandas<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span> data<span class="token punctuation">,</span>index<span class="token punctuation">,</span>columns<span class="token punctuation">,</span>dtype<span class="token punctuation">,</span>copy<span class="token punctuation">)</span>
</code></pre>
<p>构造函数的参数如下：</p>
<table>
<thead>
<tr>
<th>编号</th>
<th align="right">参数</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td align="right">data</td>
<td align="center">数据采取各种形式，如:ndarray，series，map，lists，dict，constant和另一个DataFrame。</td>
</tr>
<tr>
<td>2</td>
<td align="right">index</td>
<td align="center">对于行标签，要用于结果帧的索引是可选缺省值np.arrange(n)，如果没有传递索引值。</td>
</tr>
<tr>
<td>3</td>
<td align="right">columns</td>
<td align="center">对于列标签，可选的默认语法是 - np.arange(n)。 这只有在没有索引传递的情况下才是这样。</td>
</tr>
<tr>
<td>4</td>
<td align="right">dtype</td>
<td align="center">每列的数据类型。</td>
</tr>
<tr>
<td>5</td>
<td align="right">copy</td>
<td align="center">如果默认值为False，则此命令(或任何它)用于复制数据。</td>
</tr>
</tbody>
</table><h5><a id="23_DataFrame_104"></a>2.3 创建DataFrame</h5>
<p>Pandas数据帧(DataFrame)可以使用各种输入创建，如 -</p>
<p>列表字典系列Numpy ndarrays另一个数据帧(DataFrame)</p>
<ul>
<li>列表</li>
<li>字典</li>
<li>系列</li>
<li>Numpy ndarrays</li>
<li>另一个数据帧（DataFrame）</li>
</ul>
<h5><a id="24_DataFrame_114"></a>2.4 创建一个空的DataFrame</h5>
<p>代码示例：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
结果:
Empty DataFrame
Columns: []
Index: []
"""</span>
</code></pre>
<p>一般在创建DataFrame之后，将数据用to_csv方法进行写入到csv文件中进行存储。</p>
<h5><a id="25_Pandas_130"></a>2.5 Pandas数据合并</h5>
<p>1.concat用法</p>
<pre><code class="prism language-python">pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>objs<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> join<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">,</span> join_axes<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
       keys<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> levels<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> verify_integrity<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre>
<ul>
<li>objs:series,dataframe或者是panel构成的序列list</li>
<li>axis:需要合并链接的轴，0是行，1是列（1：以列合并，列数增加，0：以行合并，行数增加）</li>
<li>join:连接的方式inner或者outer（inner:两表的交集，outer：两表的并集）</li>
</ul>
<p>数据处理过程分析：</p>
<blockquote>
<ul>
<li><strong>EnName(19.3.5)(test).csv</strong>文件中包含EnName,MoviesName,Plot 项</li>
<li><strong>Chinese_EnName(19.3.13).csv</strong>文件中包含EnName,MoviesName,Chinese_Plot 项</li>
</ul>
</blockquote>
<p>代码示例：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
 
<span class="token comment">#读取csv文件获取操作对象</span>
<span class="token comment">#</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'EnName(19.3.5)(test).csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'Chinese_EnName(19.3.13).csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
 <span class="token comment">#合并df1,df2文件，以列合并，取他们的并集</span>
res <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> join<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
</code></pre>
<p>运行结果如图所示：<br/>
<img alt="示例1" src="https://img-blog.csdnimg.cn/20190319105325179.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NyaXNfMDUyNQ==,size_16,color_FFFFFF,t_70"/><br/>
这个时候我们发现csv数据在合并的时候，有重复项，这个时候需要我们去删除其中的重复列数据，需要用到drop方法</p>
<p>首先将重复项其中的一列更改列名来方便删除，将其中的EnName更改为C_EnName,MoviesName更改为C_MoviesName。然后进行drop操作</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
 
<span class="token comment">#定义资料集</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'EnName(19.3.5)(test).csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'Chinese_EnName(19.3.13).csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'1234.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
drop <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'C_EnName'</span><span class="token punctuation">,</span><span class="token string">'C_MoviesName'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

save <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>drop<span class="token punctuation">)</span>
save<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'1234.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment">#print(res)</span>
</code></pre>
<p>运行结果如图所示：<br/>
<img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20190319110234331.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NyaXNfMDUyNQ==,size_16,color_FFFFFF,t_70"/><br/>
可以看出数据成功进行处理，该方法适用于不考虑索引（index），并且有几列数据为重复项，则可直接进行数据处理<br/>
ps:还需要注意的点是，在concat操作或者drop操作后，通过to_csv方法保存到新文件中，会同时写入index索引值，如若不需要则需要加上参数：index = False 即可</p>
<h5><a id="26_Pandas_181"></a>2.6 Pandas去除重复项</h5>
<p>我们得到一份数据，首先我们得判断它是否具有重复项，所以我们得使用到duplicated方法来判断，如果有的情况下我们再进一步进行去重工作，在处理csv数据时，这个时候我们需要用到<strong>drop_duplicates</strong>()函数来操作文件进行去除重复项。<br/>
1. 判断是否具有重复项</p>
<pre><code class="prism language-python">a <span class="token operator">=</span> df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>a返回的是布尔值，对每一项是否第第一次出现进行判断，第一次出现输出值为False，重复项出现则输出True。</p>
<p>这个drop_duplicate方法是对DataFrame格式的数据，去除特定列下面的重复行。返回DataFrame格式的数据。<br/>
例如，data.csv如下所示：</p>
<pre><code class="prism language-csv">EnName,Gender
Peter,male
Peter，female
Cris,male
Mary,female
Pink,female
Peter,male
Pink,female
</code></pre>
<p>我们需要去除EnName和Gender项同时重复的数据，可以看出Peter，male项和Pink，female项为重复项，代码如下所示：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'EnName'</span><span class="token punctuation">,</span><span class="token string">'Gender'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'first'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre>
<p>执行代码，结果如下图所示：<br/>
<img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20190328084713854.png"/><br/>
重复项已被处理，如若我们需要去除单列重复的该项数据，例如EnName为Peter的数据项有多个，则代码如下所示：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'EnName'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'first'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre>
<p>执行代码，结果如下图所示：<br/>
<img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20190328084929602.png"/><br/>
即成功处理数据重复项。</p>
<h5><a id="27_Pandas_225"></a>2.7 Pandas索引和选择数据</h5>
<p>pandas中有三种索引方法：.loc，.iloc和[]，注意：.ix的用法在0.20.0中已经不建议使用了！</p>
<table>
<thead>
<tr>
<th>编号</th>
<th align="right">索引</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td align="right">.loc()</td>
<td align="center">基于标签</td>
</tr>
<tr>
<td>2</td>
<td align="right">.iloc()</td>
<td align="center">基于整数</td>
</tr>
<tr>
<td>3</td>
<td align="right">.ix()</td>
<td align="center">基于标签和整数</td>
</tr>
</tbody>
</table><h5><a id="271_df__233"></a>2.7.1 df[ ]:</h5>
<p>一维</p>
<ul>
<li>行维度：整数切片、标签切片、&lt;布尔数组&gt;</li>
<li>列维度：标签索引、标签列表、Callable</li>
</ul>
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre>
<p>取该csv文件中index为[0:3]的行数</p>
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">,</span>engine<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'EnName'</span><span class="token punctuation">]</span>
</code></pre>
<p>取该csv文件中列名为EnName项</p>
<h5><a id="272_dfloc__247"></a>2.7.2 df.loc[ ]:</h5>
<p>二维，先行后列</p>
<ul>
<li>行维度：标签索引、标签切片、标签列表、&lt;布尔数组&gt;、Callable</li>
<li>列维度：  标签索引、标签切片、标签列表、&lt;布尔数组&gt;、Callable</li>
</ul>
<p>.loc主要是基于标签(label)的，包括行标签(index)和列标签(columns)，即行名称和列名称，可以使用df.loc[index_name,col_name]，选择指定位置的数据，其它的用法有：</p>
<pre><code class="prism language-python">df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'EnName'</span><span class="token punctuation">]</span>
</code></pre>
</div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"/>
</link></div>
</article>
</div>